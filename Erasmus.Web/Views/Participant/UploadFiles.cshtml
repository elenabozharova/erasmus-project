@model Erasmus.Domain.DTO.ApplyToEventDto
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@await Component.InvokeAsync("Notyf") 

<form method="post" asp-controller="Participant" asp-action="UploadFiles" enctype="multipart/form-data">
    <input type="hidden" asp-for="ProjectId"/>
    <h1>Applying to @Model.Project.ProjectTitle</h1>
    <div>
        Please use the template file for CV for applying to these events
    </div>
    @if (Model.UploadedCV == null)
    {
        <div>
            <a asp-controller="Participant" asp-action="DownloadCvTemplate" asp-route-id="@Model.ProjectId" >CV Template</a>
            <label>Attach a CV</label>
            <input type="file" class="file-input" asp-for="CV"/>
        </div>
    }
    else
    {
        <label>Uploaded CV: @Model.UploadedCV.FileName</label>
        <div>
            <a class="btn btn-primary" asp-controller="Participant" asp-action="ShowUploadedFile" asp-route-id="@Model.UploadedCV.Id" class="btn btn-primary"><label>Download</label></a>
            <a class="btn btn-danger" asp-controller="Participant" asp-action="DeleteUploadedFile" asp-route-id="@Model.UploadedCV.Id">Delete</a>
        </div>

    }

    @if(Model.UploadedMotivation == null)
    {
         <div>
            <label>Attach a Motivation Letter</label>
            <input type="file" class="file-input" asp-for="MotivationLetter"/>
        </div>
    }
    else
    {
        <div>
            <h1>Your Motivation Letter</h1>
            <a asp-controller="Participant" asp-action="ShowUploadedFile" asp-route--id="@Model.UploadedMotivation.Id"><label>@Model.UploadedMotivation.FileName</label></a>
            <a class="btn btn-danger" asp-controller="Participant" asp-action="DeleteUploadedFile" asp-route-id="@Model.UploadedMotivation.Id">Delete</a>
        </div>
    }
    <button type="submit" class="btn btn-success">Submit</button>
</form>

@section Scripts{
    <script>
        $(document).ready(function(){
            $('.file-input').change(function(){
                var fileName = $(this).val().split("\\").pop();
                $(this).next('file-name').html(fileName);
            });
        });
    </script>
}